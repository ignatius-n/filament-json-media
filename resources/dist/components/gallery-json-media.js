function f(i){return i?i>1e3*1e3?((i/(1e3*1e3)).toFixed(1)+" Mb").replace(".",","):i>1024?((i/1e3).toFixed(1)+" kb").replace(".",","):(i.toFixed(1)+" *kb").replace(".",","):"unknow size"}function w(i,s){return i instanceof File?{name:i.name,size:i.size,mime_type:i.type,is_new:!0,is_success:!1,error:!1,filekey:s,progress:0,url:URL.createObjectURL(i)}:!1}function F(i){return{_minSize:null,_maxSize:null,_acceptedFileTypes:null,minSize(s){return this._minSize=s,this},maxSize(s){return this._maxSize=s,this},fileType(s){return this._acceptedFileTypes=s,this},check(){return!_(i,this._acceptedFileTypes)||!U(i,this._maxSize)||!z(i,this._minSize)}}}function m(i,s,g){let o=i.length+g;return!(s&&o>s)}function z(i,s){return!(s&&i.size>s)}function U(i,s){return!(s&&i.size>s*1024)}function _(i,s){return s?s.filter(o=>o===i.type).length>0:!0}function C(){return("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,i=>(i^crypto.getRandomValues(new Uint8Array(1))[0]&15>>i/4).toString(16))}function x(i){return{xls(){return`<svg width="336" height="236" viewBox="0 0 336 236" fill="none" xmlns="http://www.w3.org/2000/svg" class="object-cover w-full">
                        <rect width="336" height="236" fill="white"/>
                        <path d="M178.933 118L204.444 154.4H182.578L168 133.597L153.422 154.4H131.555L157.067 118L131.555 81.6H153.422L168 102.403L182.578 81.6H195.333V45.2H104.222V190.8H231.778V81.6H204.444L178.933 118ZM86 36.0272C86 31.0404 90.0727 27 95.0929 27H204.444L250 72.5V199.827C250.009 201.023 249.783 202.209 249.333 203.317C248.884 204.426 248.22 205.435 247.38 206.286C246.539 207.138 245.539 207.817 244.436 208.282C243.334 208.748 242.15 208.992 240.952 209H95.0473C92.6545 208.983 90.3644 208.027 88.6715 206.338C86.9787 204.649 86.0191 202.363 86 199.973V36.0272Z" fill="#277C4E"/>
                    </svg>`},word(){return`<svg width="336" height="236" viewBox="0 0 336 236" fill="none" xmlns="http://www.w3.org/2000/svg"  class="object-cover w-full">
                        <rect width="336" height="236" fill="white"/>
                        <path d="M183.25 41.75H122.25C118.205 41.75 114.327 43.3567 111.467 46.2166C108.607 49.0766 107 52.9554 107 57V179C107 187.464 113.786 194.25 122.25 194.25H213.75C222.214 194.25 229 187.464 229 179V87.5L183.25 41.75ZM213.75 179H122.25V57H175.625V95.125H213.75V179ZM208.794 102.75L192.781 171.375H182.106L168.381 119.601L154.656 171.375H143.981L127.206 102.75H138.644L149.319 154.676L163.044 102.75H172.956L186.681 154.676L197.356 102.75H208.794Z" fill="#107CE1"/>
                    </svg>`},pdf(){return`<svg width="336" height="236" viewBox="0 0 336 236" fill="none" xmlns="http://www.w3.org/2000/svg"  class="object-cover w-full">
                    <rect width="336" height="236" fill="white"/>
                    <g clip-path="url(#clip0_201_5)">
                    <path d="M234.958 93.9513H230.614L230.843 77.9808C230.815 77.0475 230.456 76.1545 229.829 75.4627L192.513 34.6323C192.214 34.2898 191.847 34.0125 191.435 33.8177C191.024 33.6229 190.577 33.5148 190.122 33.5H112.044C110.293 33.5281 108.622 34.2343 107.382 35.47C106.141 36.7056 105.429 38.3743 105.394 40.1248V93.9513H101.042C98.6339 93.9513 96.3101 94.9484 94.6201 96.7229C92.8958 98.5264 91.9386 100.929 91.9499 103.424V152.687C91.9499 157.909 96.0228 162.151 101.042 162.151H105.394V195.867C105.427 197.622 106.141 199.295 107.385 200.533C108.629 201.771 110.306 202.476 112.061 202.5H224.26C227.767 202.5 230.851 199.526 230.851 195.875V162.16H234.966C239.985 162.16 244.058 157.909 244.058 152.679V103.415C244.058 100.914 243.104 98.4974 241.397 96.7229C240.569 95.8514 239.573 95.1566 238.469 94.6803C237.365 94.204 236.177 93.956 234.975 93.9513H234.958ZM116.877 45.1441H175.656V83.8197C175.652 84.6906 175.985 85.5291 176.585 86.1604C176.876 86.4663 177.226 86.7101 177.614 86.8771C178.002 87.0442 178.419 87.1309 178.841 87.1321H219.055V93.9513H116.877V45.1441ZM116.877 190.856V162.151H219.055V190.856H116.877ZM187.359 46.344L190.612 50.0113L212.413 74.1192L213.621 75.581H191.339C189.649 75.581 188.593 75.3022 188.145 74.736C187.697 74.1868 187.435 73.2995 187.359 72.0911V46.344ZM108.85 153.76V103.06H125.057C131.192 103.06 135.197 103.314 137.056 103.821C139.929 104.581 142.329 106.238 144.264 108.789C146.19 111.333 147.162 114.62 147.162 118.659C147.162 121.769 146.605 124.388 145.489 126.518C144.374 128.63 142.954 130.295 141.239 131.503C139.671 132.648 137.889 133.467 136 133.911C133.592 134.393 130.102 134.638 125.53 134.638H118.948V153.76H108.85ZM118.948 111.637V126.027H124.474C128.454 126.027 131.116 125.757 132.459 125.233C133.758 124.743 134.87 123.858 135.64 122.704C136.41 121.549 136.799 120.182 136.752 118.794C136.813 117.125 136.24 115.494 135.146 114.231C134.091 113.04 132.66 112.247 131.09 111.984C129.89 111.755 127.465 111.646 123.823 111.646H118.948V111.637ZM153.086 103.06H171.54C175.706 103.06 178.875 103.381 181.064 104.032C183.996 104.902 186.505 106.466 188.601 108.697C190.688 110.936 192.285 113.674 193.375 116.91C194.474 120.155 195.015 124.143 195.015 128.892C195.015 133.066 194.508 136.666 193.477 139.683C192.226 143.375 190.435 146.358 188.119 148.64C186.37 150.372 184.004 151.724 181.021 152.696C178.799 153.405 175.816 153.76 172.09 153.76H153.086V103.06ZM163.183 111.637V145.217H170.721C173.543 145.217 175.58 145.057 176.83 144.736C178.469 144.313 179.83 143.62 180.903 142.623C181.985 141.635 182.872 140.004 183.548 137.731C184.232 135.458 184.57 132.365 184.57 128.444C184.57 124.523 184.232 121.515 183.556 119.42C183.02 117.571 182.032 115.884 180.683 114.51C179.379 113.293 177.761 112.465 176.011 112.119C174.599 111.798 171.836 111.637 167.73 111.637H163.183ZM201.318 153.76V103.06H235.6V111.637H211.416V123.636H232.288V132.213H211.416V153.76H201.318Z" fill="#D90707"/>
                    </g>
                    <defs>
                    <clipPath id="clip0_201_5">
                    <rect width="169" height="169" fill="white" transform="translate(83.5 33.5)"/>
                    </clipPath>
                    </defs>
                   </svg>`},unKnown(){return`<svg width="336" height="236" viewBox="0 0 336 236" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="336" height="236" fill="white"/>
                        <path d="M224.667 95.2857H179.333V49.8571H111.333V186.143H224.667V95.2857ZM219.975 83.9286L190.667 54.559V83.9286H219.975ZM105.667 38.5H190.667L236 83.9286V191.821C236 193.327 235.403 194.772 234.34 195.837C233.278 196.902 231.836 197.5 230.333 197.5H105.667C104.164 197.5 102.722 196.902 101.66 195.837C100.597 194.772 100 193.327 100 191.821V44.1786C100 42.6725 100.597 41.2282 101.66 40.1632C102.722 39.0983 104.164 38.5 105.667 38.5ZM134 118H202V129.357H134V118ZM134 83.9286H162.333V95.2857H134V83.9286ZM134 152.071H202V163.429H134V152.071Z" fill="#8B9292"/>
                    </svg>`},getFile(){try{if(i.mime_type.startsWith("image"))return`<img src="${i.url}" alt="${i.name}" class="object-cover w-full" loading="lazy">`;if(i.name.toLowerCase().endsWith(".pdf"))return this.pdf();if(i.name.toLowerCase().endsWith(".xls")||i.name.toLowerCase().endsWith(".xlsx"))return this.xls();if(i.name.toLowerCase().endsWith(".doc")||i.name.toLowerCase().endsWith(".docx"))return this.word()}catch{}return this.unKnown()}}}function j({state:i,statePath:s,minSize:g,maxSize:o,maxFiles:p,isMultiple:B,isDeletable:H,isDisabled:I,isDownloadable:O,uploadingMessage:v,isReorderable:y,acceptedFileTypes:L,hasCustomPropertiesAction:V,deleteUploadedFileUsing:b,getUploadedFilesUsing:D,removeUploadedFileUsing:S,customPropertyActionName:$,reorderUploadedFilesUsing:k}){return{state:i,statePath:s,customPropertyActionName:$,hasCustomPropertiesAction:V,isDeletable:H,isReorderable:y,lastState:null,uploadFiles:[],uploadedFileIndex:{},editingFile:{},startUpload:!1,fileKeyIndex:{},progress:0,_startSwipeX:0,stopDragging:!0,getHumanSize(e){return f(e)},uploadUsing:(e,t,r,n,h,d)=>{this.$wire.upload(`${s}.${e}`,t,c=>{r(d)},()=>{n(d)},c=>{h(d,c)})},getFileName:function(e){if(e.startsWith("blob:")||e.startsWith("livewire:"))return e;let t=e.lastIndexOf("/");return t!==-1?e.slice(t+1):e},getContentImage(e){return x(e).getFile()},saveFilesUsing(e){let t=this.$refs.galleryImages,r=function(l){l.uploadFiles.filter(M=>M.is_success===!1).length===0&&(l.dispatchFormEvent("form-processing-finished"),l.startUpload=!1)},n=l=>{this.uploadFiles[l].is_success=!0,this.uploadFiles[l].progress=0,r(this)},h=l=>{this.uploadFiles[l].progress=0,this.uploadFiles[l].error=!0,r(this)},d=(l,a)=>{this.uploadFiles[l].progress=a.detail.progress},c=e.length,u=0;if(c){if(!m(e,p,c)){new FilamentNotification().title("Max Files reach").danger().send();return}this.startUpload||this.dispatchFormEvent("form-processing-started",{message:v}),this.startUpload=!0;for(let l of Array.from(e)){if(F(l).fileType(L).maxSize(o).minSize(g).check()){new FilamentNotification().title(`File "${l.name}" invalid`).warning().send();continue}let a=w(l,C());a&&(this.uploadFiles.push({...a}),this.uploadUsing(a.filekey,l,n,h,d,this.uploadFiles.length-1),u++)}setTimeout(()=>{t.scrollTo({left:t.scrollWidth,behavior:"smooth"})},30),u===0&&(this.startUpload=!1,this.dispatchFormEvent("form-processing-finished"))}},laFileInput:{async"@change"(){let e=this.$event.target.files;await this.saveFilesUsing(e)}},onScrolling:{"@wheel.stop"(e){let t=Object.entries(this.uploadFiles).length,r=this.$refs.galleryImages,n=this.$refs.ulGalleryWrapper;if(t*320>r.clientWidth){let h=e.deltaY<0?-280:280;(e.deltaY>0&&r.scrollLeft>=0&&r.scrollLeft+r.clientWidth<n.clientWidth||e.deltaY<0&&r.scrollLeft>0)&&(e.preventDefault(),r.scrollTo({left:r.scrollLeft+h,behavior:"smooth"}))}}},pointerNone:{"@pointerenter"(e){let t=this.$refs.galleryImages;t.style.pointerEvents="none"},"@pointerleave"(e){let t=this.$refs.galleryImages;t.style.pointerEvents="auto"}},dropZone:{"@click.prevent.stop"(){this.$refs.laFileInput.click()},"@dragover.prevent.stop"(){this.$event.target.classList.contains("wm-json-media-dropzone")},async"@drop.prevent.stop"(){this.$event.target.classList.contains("wm-json-media-dropzone")&&(await this.saveFilesUsing(this.$event.dataTransfer.files),this.$refs.dropzone.classList.remove("wm-dropzone"))},"@dragenter.prevent.stop"(){this.$refs.dropzone.classList.add("wm-dropzone")},"@dragleave.prevent.stop"(){return this.$event.target===this.$refs.dropzone&&this.$refs.dropzone.classList.remove("wm-dropzone"),!1}},leftArrow:{"@click.stop"(){let e=Object.entries(this.uploadFiles).length,t=this.$refs.galleryImages;t.scrollLeft>0&&t.scroll({left:t.scrollLeft-300,behavior:"smooth"})}},rightArrow:{"@click.stop"(){let e=this.$refs.galleryImages;e.scrollLeft+e.clientWidth<e.scrollWidth&&e.scroll({left:e.scrollLeft+300,behavior:"smooth"})}},removeUploadFile:async function(e,t){await S(e),this.uploadFiles.splice(t,1)},deleteUploadFile:async function(e,t){await b(e),this.uploadFiles.splice(t,1)},getImageWrapperElementFromKey(e){return this.$refs.galleryImages.querySelector(`div[id="id_${e.replaceAll("-","")}"]`)},getUploadedFiles:async function(){let e=await D();this.fileKeyIndex=e??{},this.uploadedFileIndex=Object.entries(this.fileKeyIndex).filter(([t,r])=>r?.url).reduce((t,[r,n])=>(t[n.url]=r,t),{})},async getFiles(){return await this.getUploadedFiles(),Object.entries(this.fileKeyIndex).reduce((e,[t,r])=>(r.error=!1,r.is_success=!0,r.is_new=!1,r.filekey=t,e.push({...r}),e),[])},getUpdateFileEntries:function(){return Object.entries(this.state).map((e,t)=>(delete e.deleted,{key:e}))},dispatchFormEvent:function(e,t={}){this.$el.closest("form")?.dispatchEvent(new CustomEvent(e,{composed:!0,cancelable:!0,detail:t}))},canUpload:function(){return p?Object.entries(this.uploadFiles).length<=p:!0},init(){this.$watch("state",async()=>{if(this.state!==void 0){if(this.state!==null&&Object.values(this.state).filter(e=>e.file.startsWith("livewire-file:")).length){this.lastState=null;return}JSON.stringify(this.getUpdateFileEntries())!==this.lastState&&(this.lastState=JSON.stringify(this.getUpdateFileEntries()),this.uploadFiles=await this.getFiles())}}),this.$watch("sortKeys",async()=>{await k(this.sortKeys)}),this.$nextTick(async()=>{this.uploadFiles=await this.getFiles()})},dropcheck:0,usedKeyboard:!1,originalIndexBeingDragged:null,indexBeingDragged:null,indexBeingDraggedOver:null,preDragOrder:null,sortKeys:null,dragstart(e){this.preDragOrder=[...this.uploadFiles],this.indexBeingDragged=e.target.getAttribute("x-ref"),this.originalIndexBeingDragged=e.target.getAttribute("x-ref"),e.dataTransfer.dropEffect="copy"},updateListOrder(e){if(this.indexBeingDragged){this.indexBeingDraggedOver=e.target.getAttribute("x-ref");let t=this.indexBeingDragged,r=this.indexBeingDraggedOver;if(this.indexBeingDragged===r||t===r)return;this.move(t,r),this.indexBeingDragged=r}},setParentDraggable(e){e.target.closest("li").setAttribute("draggable",!0)},setParentNotDraggable(e){e.target.closest("li").setAttribute("draggable",!1)},resetState(){this.dropcheck=0,this.indexBeingDragged=null,this.preDragOrder=[...this.uploadFiles],this.indexBeingDraggedOver=null,this.originalIndexBeingDragged=null},revertState(){this.uploadFiles=this.preDragOrder.length?this.preDragOrder:this.uploadFiles,this.resetState()},rePositionPlaceholder(){this.uploadFiles=[...this.preDragOrder],this.indexBeingDragged=this.originalIndexBeingDragged},move(e,t){let r=this.uploadFiles;if(t>=r.length){let n=t-r.length+1;for(;n--;)r.push(void 0)}r.splice(t,0,r.splice(e,1)[0]),this.uploadFiles=r},getSort(){if(this.indexBeingDragged===this.originalIndexBeingDragged)return null;this.sortKeys=this.uploadFiles.map(e=>e.filekey)}}}export{j as galleryFileUpload};
